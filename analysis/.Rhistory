scale_x_discrete(labels = c('away' = 'Away from mesquite', 'under' = 'Under mesquite'))
grass_percent_boxplot
grass_percent_boxplot = ggplot(data = forb_ratio_df, aes(x = location, y =  1 - (forb_ratio * 100))) +
theme(legend.position="none",
axis.title.y=element_text(size=rel(3), colour = 'black'),
axis.title.x=element_text(size=rel(3), colour = 'black'),
axis.text.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.y=element_text(size=rel(2), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
#axis.line = element_line(colour = 'black'),
strip.text = element_text(size=rel(1))) +
geom_boxplot(fill = c('yellow', 'grey'), lwd = 4) +
ylab(expression('C'[4] * ' Grass Biomass (%)')) +
xlab('') +
scale_x_discrete(labels = c('away' = 'Away from mesquite', 'under' = 'Under mesquite'))
grass_percent_boxplot
grass_percent_boxplot = ggplot(data = forb_ratio_df, aes(x = location, y =  100 - (forb_ratio * 100))) +
theme(legend.position="none",
axis.title.y=element_text(size=rel(3), colour = 'black'),
axis.title.x=element_text(size=rel(3), colour = 'black'),
axis.text.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.y=element_text(size=rel(2), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
#axis.line = element_line(colour = 'black'),
strip.text = element_text(size=rel(1))) +
geom_boxplot(fill = c('yellow', 'grey'), lwd = 4) +
ylab(expression('C'[4] * ' Grass Biomass (%)')) +
xlab('') +
scale_x_discrete(labels = c('away' = 'Away from mesquite', 'under' = 'Under mesquite'))
grass_percent_boxplot
head(sm)
sm$spot = paste(sm$plot, sm$location, sep = '_')
sm_lmer = lmer(vwc ~ location + (1|plot) + (1|spot), data = sm)
Anova(sm_lmer)
sm_lmer = lmer(vwc ~ location + (1|spot), data = sm)
Anova(sm_lmer)
sm_lmer = lmer(vwc ~ location + (1|plot), data = sm)
Anova(sm_lmer)
sm_lmer = lmer(vwc ~ location + (1|plot) + (1|spot), data = sm)
plot(resid(sm_lmer) ~ fitted(sm_lmer))
hist(sm$vwc)
sm_lmer = lmer(vwc ~ location + (1|plot) + (1|spot), data = sm)
plot(resid(sm_lmer) ~ fitted(sm_lmer))
sm_lmer = lm(vwc ~ location, data = sm)
plot(resid(sm_lmer) ~ fitted(sm_lmer))
sm_lmer = lmer(vwc ~ location + (1|plot) + (1|spot), data = sm)
plot(resid(sm_lmer) ~ fitted(sm_lmer))
plot(fitted(sm_lmer) ~ resid(sm_lmer))
plot(resid(sm_lmer) ~ fitted(sm_lmer))
summary(sm_lmer)
sm$plotfac = as.factor(sm$plot)
hist(sm$vwc)
sm_lmer = lmer(vwc ~ location + (1|plot) + (1|spot), data = sm)
summary(sm_lmer)
plot(resid(sm_lmer) ~ fitted(sm_lmer))
Anova(sm_lmer)
sm_lmer = lmer(vwc ~ location + (1|plotfac) + (1|spot), data = sm)
summary(sm_lmer)
plot(resid(sm_lmer) ~ fitted(sm_lmer))
Anova(sm_lmer)
sm$spot
sm$plotfac
fitted(sm_lmer)
hist(sm$vwc)
hist(log(sm$vwc))
sm_lmer = lmer(log(vwc) ~ location + (1|plotfac) + (1|spot), data = sm)
summary(sm_lmer)
plot(resid(sm_lmer) ~ fitted(sm_lmer))
Anova(sm_lmer)
##########################################################################################
### Q2: How does mesquite presence influence soil moisture?
##########################################################################################
#### run paired t-tests for all data and each date
sm_dates = levels(sm$date)
t.test(subset(sm, location == 'under')$vwc, subset(sm, location == 'away')$vwc,
paired = T)
t.test(subset(sm, location == 'under' & date == sm_dates[1])$vwc,
subset(sm, location == 'away' & date == sm_dates[1])$vwc,
paired = T)
t.test(subset(sm, location == 'under' & date == sm_dates[2])$vwc,
subset(sm, location == 'away' & date == sm_dates[2])$vwc,
paired = T)
t.test(subset(sm, location == 'under' & date == sm_dates[3])$vwc,
subset(sm, location == 'away' & date == sm_dates[3])$vwc,
paired = T)
t.test(subset(sm, location == 'under' & date == sm_dates[4])$vwc,
subset(sm, location == 'away' & date == sm_dates[4])$vwc,
paired = T)
t.test(subset(sm, location == 'under' & date == sm_dates[5])$vwc,
subset(sm, location == 'away' & date == sm_dates[5])$vwc,
paired = T)
t.test(subset(sm, location == 'under' & date == sm_dates[6])$vwc,
subset(sm, location == 'away' & date == sm_dates[6])$vwc,
paired = T)
t.test(subset(sm, location == 'under' & date == sm_dates[7])$vwc,
subset(sm, location == 'away' & date == sm_dates[7])$vwc,
paired = T)
t.test(subset(sm, location == 'under' & date == sm_dates[8])$vwc,
subset(sm, location == 'away' & date == sm_dates[8])$vwc,
paired = T)
sm_lmer = lmer(vwc ~ location * date + (1|plotfac) + (1|spot), data = sm)
summary(sm_lmer)
plot(resid(sm_lmer) ~ fitted(sm_lmer))
Anova(sm_lmer)
hist(bm_total$weight_sum)
hist(log(bm_total$weight_sum))
bm_total_lmer = lmer(log(weight_sum) ~ location * date + (1|plotfac) + (1|spot), data = bm_total)
bm_total$spot = paste(bm_total$plot, bm_total$location, sep = '_')
bm_total$plotfac = as.factor(bm_total$plot)
hist(log(bm_total$weight_sum))
bm_total_lmer = lmer(log(weight_sum) ~ location * date + (1|plotfac) + (1|spot), data = bm_total)
bm_total_lmer = lmer(log(weight_sum) ~ location + (1|plotfac) + (1|spot), data = bm_total)
hist(log(bm_total$weight_sum))
bm_total$plotfac
bm_total$spot
bm_total_lmer = lmer(log(weight_sum) ~ location + (1|plotfac), data = bm_total)
summary(bm_total_lmer)
log(bm_total$weight_sum)
hist(bm_total$weight_sum)
bm_total$weight_sum
hist(log(bm_total$weight_sum + 0.01))
bm_total_lmer = lmer(log(weight_sum + 0.01) ~ location + (1|plotfac), data = bm_total)
summary(bm_total_lmer)
plot(resid(bm_total_lmer) ~ fitted(bm_total_lmer))
Anova(bm_total_lmer)
emmeans(bm_total_lmer, ~location)
sc_diversity$spot = paste(sc_diversity$plot, sc_diversity$location, sep = '_')
sc_diversity$plotfac = as.factor(sc_diversity$plot)
hist(log(sc_diversity$H))
hist(sc_diversity$H)
H_lmer = lmer(log(H) ~ location + (1|plotfac), data = sc_diversity)
log(sc_diversity$H)
sc_diversity$H
hist(log(sc_diversity$H + 0.01))
H_lmer = lmer(log(H + 0.01) ~ location + (1|plotfac), data = sc_diversity)
summary(H_lmer)
plot(resid(H_lmer) ~ fitted(H_lmer))
Anova(H_lmer)
emmeans(H_lmer, ~location)
forb_ratio_df$spot = paste(forb_ratio_df$plot, forb_ratio_df$location, sep = '_')
forb_ratio_df$plotfac = as.factor(forb_ratio_df$plot)
forb_ratio_df$H
forb_ratio_df$forb_ratio
forb_ratio
bm_lifeform_forb$weight_sum
rowSums(cbind(bm_lifeform_forb$weight_sum, bm_lifeform_grass$weight_sum,
bm_lifeform_tree$weight_sum))
forb_ratio_df$forb_ratio
hist(log(forb_ratio_df$forb_ratio + 0.01))
hist(forb_ratio_df$forb_ratio)
hist(log(forb_ratio_df$forb_ratio + 0.01))
hist(forb_ratio_df$forb_ratio)
hist(log(forb_ratio_df$forb_ratio + 0.01))
hist(forb_ratio_df$forb_ratio)
forb_ratio_lmer = lmer(log(forb_ratio + 0.01) ~ location + (1|plotfac), data = forb_ratio_df)
summary(forb_ratio_lmer)
plot(resid(forb_ratio_lmer) ~ fitted(forb_ratio_lmer))
Anova(forb_ratio_lmer)
emmeans(forb_ratio_lmer, ~location)
1.55-0.67
## load libraries
library(tidyverse)
library(vioplot)
library(lme4)
library(car)
library(emmeans)
## ggplot theme
th = theme(legend.position="none",
axis.title.y=element_text(size=rel(1.5), colour = 'black'),
axis.title.x=element_text(size=rel(1.5), colour = 'black'),
axis.text.x=element_text(size=rel(1.5), colour = 'black'),
axis.text.y=element_text(size=rel(1.5), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
#axis.line = element_line(colour = 'black'),
strip.text = element_text(size=rel(1)))
## read in data
sm = read.csv("../data/sm_clean.csv") # soil moisture
bm = read.csv("../data/bm_clean.csv") # biomass
lai = read.csv("../data/lai_clean.csv") # lai
sc = read.csv("../data/sc_clean.csv") # cover (species composition)
##########################################################################################
### Q1: What does the size distribution (in LAI) of the trees look like?
##########################################################################################
#### mean plot lai
lai_group_by_plot = group_by(lai, plot)
lai_mean = summarise(lai_group_by_plot, lai_mean = mean(lai))
##########################################################################################
### Q2: How does mesquite presence influence soil moisture?
##########################################################################################
#### run paired t-tests for all data and each date
sm_dates = levels(sm$date)
sm_boxplot = ggplot(data = sm, aes(x = location, y = vwc)) +
theme(legend.position="none",
axis.title.y=element_text(size=rel(3), colour = 'black'),
axis.title.x=element_text(size=rel(3), colour = 'black'),
axis.text.x=element_text(size=rel(3), colour = 'black'),
axis.text.y=element_text(size=rel(2), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
#axis.line = element_line(colour = 'black'),
strip.text = element_text(size=rel(1))) +
geom_boxplot(fill = c('yellow', 'grey'), lwd = 4) +
ylab('Soil water content (%)') +
xlab('') +
scale_x_discrete(labels = c('away' = 'Outside', 'under' = 'Under'))
sm_boxplot
sm_boxplot = ggplot(data = sm, aes(x = location, y = vwc)) +
theme(legend.position="none",
axis.title.y=element_text(size=rel(4), colour = 'black'),
axis.title.x=element_text(size=rel(4), colour = 'black'),
axis.text.x=element_text(size=rel(3), colour = 'black'),
axis.text.y=element_text(size=rel(3), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
#axis.line = element_line(colour = 'black'),
strip.text = element_text(size=rel(1))) +
geom_boxplot(fill = c('yellow', 'grey'), lwd = 4) +
ylab('Soil water content (%)') +
xlab('') +
scale_x_discrete(labels = c('away' = 'Outside', 'under' = 'Under'))
sm_boxplot
sm_boxplot = ggplot(data = sm, aes(x = location, y = vwc)) +
theme(legend.position="none",
axis.title.y=element_text(size=rel(4), colour = 'black'),
axis.title.x=element_text(size=rel(5), colour = 'black'),
axis.text.x=element_text(size=rel(3), colour = 'black'),
axis.text.y=element_text(size=rel(3), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
#axis.line = element_line(colour = 'black'),
strip.text = element_text(size=rel(1))) +
geom_boxplot(fill = c('yellow', 'grey'), lwd = 4) +
ylab('Soil water content (%)') +
xlab('') +
scale_x_discrete(labels = c('away' = 'Outside', 'under' = 'Under'))
sm_boxplot = ggplot(data = sm, aes(x = location, y = vwc)) +
theme(legend.position="none",
axis.title.y=element_text(size=rel(4), colour = 'black'),
axis.title.x=element_text(size=rel(4), colour = 'black'),
axis.text.x=element_text(size=rel(4), colour = 'black'),
axis.text.y=element_text(size=rel(3), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
#axis.line = element_line(colour = 'black'),
strip.text = element_text(size=rel(1))) +
geom_boxplot(fill = c('yellow', 'grey'), lwd = 4) +
ylab('Soil water content (%)') +
xlab('') +
scale_x_discrete(labels = c('away' = 'Outside', 'under' = 'Under'))
sm_boxplot
sm_boxplot = ggplot(data = sm, aes(x = location, y = vwc)) +
theme(legend.position="none",
axis.title.y=element_text(size=rel(4), colour = 'black'),
axis.title.x=element_text(size=rel(4), colour = 'black'),
axis.text.x=element_text(size=rel(4), colour = 'black'),
axis.text.y=element_text(size=rel(3), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
#axis.line = element_line(colour = 'black'),
strip.text = element_text(size=rel(1))) +
geom_boxplot(fill = c('yellow', 'grey'), lwd = 4) +
ylab('Soil water content (%)') +
xlab('Location rel. to Mesquite') +
scale_x_discrete(labels = c('away' = 'Outside', 'under' = 'Under'))
sm_boxplot
sm_boxplot = ggplot(data = sm, aes(x = location, y = vwc)) +
theme(legend.position="none",
axis.title.y=element_text(size=rel(4), colour = 'black'),
axis.title.x=element_text(size=rel(4), colour = 'black'),
axis.text.x=element_text(size=rel(4), colour = 'black'),
axis.text.y=element_text(size=rel(3), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
#axis.line = element_line(colour = 'black'),
strip.text = element_text(size=rel(1))) +
geom_boxplot(fill = c('yellow', 'grey'), lwd = 4) +
ylab('Soil water content (%)') +
xlab('LRT Mesquite') +
scale_x_discrete(labels = c('away' = 'Outside', 'under' = 'Under'))
sm_boxplot
sm_boxplot = ggplot(data = sm, aes(x = location, y = vwc)) +
theme(legend.position="none",
axis.title.y=element_text(size=rel(4), colour = 'black'),
axis.title.x=element_text(size=rel(4), colour = 'black'),
axis.text.x=element_text(size=rel(4), colour = 'black'),
axis.text.y=element_text(size=rel(3), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
#axis.line = element_line(colour = 'black'),
strip.text = element_text(size=rel(1))) +
geom_boxplot(fill = c('yellow', 'grey'), lwd = 4) +
ylab('Soil water content (%)') +
xlab('') +
scale_x_discrete(labels = c('away' = 'Outside', 'under' = 'Under'))
sm_boxplot
bm_nolitt = subset(bm, code != 'LITT')
##### create dateframe with correct columns for total biomass
bm_total_pre = data.frame(plot = rep(seq(1, 40), 2),
location = c(rep('under', 40), rep('away', 40)),
date = rep('2018-09-22', times = 80))
nrow(bm_total_pre)
##### get total biomass for each plot (excluding dead stuff)
bm_total_group_by = group_by(bm_nolitt, date, plot, location)
bm_total_sums = summarise(bm_total_group_by, weight_sum = sum(weight))
##### combine sums into data fram with zeros
bm_total = left_join(bm_total_pre, bm_total_sums)
head(bm_total)
bm_total$weight_sum[is.na(bm_total$weight_sum)] = 0
head(bm_total)
tail(bm_total)
bm_boxplot = ggplot(data = bm_total, aes(x = location, y = weight_sum * 4)) +
theme(legend.position="none",
axis.title.y=element_text(size=rel(4), colour = 'black'),
axis.title.x=element_text(size=rel(4), colour = 'black'),
axis.text.x=element_text(size=rel(4), colour = 'black'),
axis.text.y=element_text(size=rel(3), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
#axis.line = element_line(colour = 'black'),
strip.text = element_text(size=rel(1))) +
geom_boxplot(fill = c('yellow', 'grey'), lwd = 4) +
ylab(expression('Understory Biomass (g m'^'-2' *')')) +
xlab('') +
scale_x_discrete(labels = c('away' = 'Away from mesquite', 'under' = 'Under mesquite'))
bm_boxplot
bm_boxplot = ggplot(data = bm_total, aes(x = location, y = weight_sum * 4)) +
theme(legend.position="none",
axis.title.y=element_text(size=rel(4), colour = 'black'),
axis.title.x=element_text(size=rel(4), colour = 'black'),
axis.text.x=element_text(size=rel(4), colour = 'black'),
axis.text.y=element_text(size=rel(3), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
#axis.line = element_line(colour = 'black'),
strip.text = element_text(size=rel(1))) +
geom_boxplot(fill = c('yellow', 'grey'), lwd = 4) +
ylab(expression('Understory Biomass (g m'^'-2' *')')) +
xlab('') +
scale_x_discrete(labels = c('away' = 'Outside', 'under' = 'Under'))
bm_boxplot
bm_boxplot = ggplot(data = bm_total, aes(x = location, y = weight_sum * 4)) +
theme(legend.position="none",
axis.title.y=element_text(size=rel(4), colour = 'black'),
axis.title.x=element_text(size=rel(4), colour = 'black'),
axis.text.x=element_text(size=rel(4), colour = 'black'),
axis.text.y=element_text(size=rel(3), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
#axis.line = element_line(colour = 'black'),
strip.text = element_text(size=rel(1))) +
geom_boxplot(fill = c('yellow', 'grey'), lwd = 4) +
ylab(expression('Understory AGB (g m'^'-2' *')')) +
xlab('') +
scale_x_discrete(labels = c('away' = 'Outside', 'under' = 'Under'))
bm_boxplot
bm_lifeform_pre = data.frame(plot = rep(seq(1, 40), 8),
location = c(rep('under', 160), rep('away', 160)),
lifeform = rep(c(rep(levels(bm$lifeform)[1], 40),
rep(levels(bm$lifeform)[2], 40),
rep(levels(bm$lifeform)[3], 40),
rep(levels(bm$lifeform)[4], 40)), 2),
date = rep('2018-09-22', times = 320))
nrow(bm_lifeform_pre)
##### get lifeform biomass for each plot
bm_lifeform_group_by = group_by(bm, date, plot, location, lifeform)
bm_lifeform_sums = summarise(bm_lifeform_group_by, weight_sum = sum(weight))
##### combine sums into data fram with zeros
bm_lifeform = left_join(bm_lifeform_pre, bm_lifeform_sums)
head(bm_lifeform)
bm_lifeform$weight_sum[is.na(bm_lifeform$weight_sum)] = 0
head(bm_lifeform)
tail(bm_lifeform)
##### separate out the different lifeforms
bm_lifeform_forb = subset(bm_lifeform, lifeform == 'Forb')
bm_lifeform_grass = subset(bm_lifeform, lifeform == 'Grass')
bm_lifeform_litter = subset(bm_lifeform, lifeform == 'LITT')
bm_lifeform_tree = subset(bm_lifeform, lifeform == 'Shrub/tree')
grass_ratio = bm_lifeform_grass$weight_sum /
rowSums(cbind(bm_lifeform_forb$weight_sum, bm_lifeform_grass$weight_sum,
bm_lifeform_tree$weight_sum))
grass_ratio_df = data.frame(bm_lifeform_grass[, c(1,2)], grass_ratio = grass_ratio)
t.test(subset(grass_ratio_df, location == 'under')$grass_ratio,
subset(grass_ratio_df, location == 'away')$grass_ratio,
paired = T)
#### forb ratio
forb_ratio = bm_lifeform_forb$weight_sum /
rowSums(cbind(bm_lifeform_forb$weight_sum, bm_lifeform_grass$weight_sum,
bm_lifeform_tree$weight_sum))
forb_ratio_df = data.frame(bm_lifeform_forb[, c(1,2)], forb_ratio = forb_ratio)
forb_percent_boxplot = ggplot(data = forb_ratio_df, aes(x = location, y = forb_ratio * 100)) +
theme(legend.position="none",
axis.title.y=element_text(size=rel(4), colour = 'black'),
axis.title.x=element_text(size=rel(4), colour = 'black'),
axis.text.x=element_text(size=rel(4), colour = 'black'),
axis.text.y=element_text(size=rel(3), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
#axis.line = element_line(colour = 'black'),
strip.text = element_text(size=rel(1))) +
geom_boxplot(fill = c('yellow', 'grey'), lwd = 4) +
ylab(expression('C'[3] * ' Forb Biomass (%)')) +
xlab('') +
scale_x_discrete(labels = c('away' = 'Outside', 'under' = 'Under'))
forb_percent_boxplot
grass_percent_boxplot = ggplot(data = forb_ratio_df, aes(x = location, y =  100 - (forb_ratio * 100))) +
theme(legend.position="none",
axis.title.y=element_text(size=rel(4), colour = 'black'),
axis.title.x=element_text(size=rel(4), colour = 'black'),
axis.text.x=element_text(size=rel(4), colour = 'black'),
axis.text.y=element_text(size=rel(3), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
#axis.line = element_line(colour = 'black'),
strip.text = element_text(size=rel(1))) +
geom_boxplot(fill = c('yellow', 'grey'), lwd = 4) +
ylab(expression('C'[4] * ' Grass Biomass (%)')) +
xlab('') +
scale_x_discrete(labels = c('away' = 'Away', 'under' = 'Under'))
grass_percent_boxplot
grass_percent_boxplot = ggplot(data = forb_ratio_df, aes(x = location, y =  100 - (forb_ratio * 100))) +
theme(legend.position="none",
axis.title.y=element_text(size=rel(4), colour = 'black'),
axis.title.x=element_text(size=rel(4), colour = 'black'),
axis.text.x=element_text(size=rel(4), colour = 'black'),
axis.text.y=element_text(size=rel(3), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
#axis.line = element_line(colour = 'black'),
strip.text = element_text(size=rel(1))) +
geom_boxplot(fill = c('yellow', 'grey'), lwd = 4) +
ylab(expression('C'[4] * ' Grass Biomass (%)')) +
xlab('') +
scale_x_discrete(labels = c('away' = 'Outside', 'under' = 'Under'))
grass_percent_boxplot
bm_richness_pre = data.frame(plot = rep(seq(1, 40), 2),
location = c(rep('under', 40), rep('away', 40)),
date = rep('2018-09-22', times = 80))
nrow(bm_richness_pre)
#### calculate species richness per plot type (for non-litter)
bm_richness_group_by = group_by(bm_nolitt, date, plot, location)
bm_richness_sums = summarise(bm_richness_group_by, richness = n())
##### combine richness into data fram with zeros
bm_richness = left_join(bm_richness_pre, bm_richness_sums)
head(bm_richness)
bm_richness$richness[is.na(bm_richness$richness)] = 0
head(bm_richness)
tail(bm_richness)
##### run the analysis
t.test(subset(bm_richness, location == 'under')$richness,
subset(bm_richness, location == 'away')$richness,
paired = T)
sc_live = subset(sc, code != 'BARE' & code != 'LITT')
#### calculate richness
sc_richness_pre = data.frame(plot = rep(seq(1, 40), 2),
location = c(rep('under', 40), rep('away', 40)),
date = rep('2018-09-22', times = 80))
nrow(sc_richness_pre)
#### calculate species richness per plot type (for non-litter)
sc_richness_group_by = group_by(sc_live, date, plot, location)
sc_richness_sums = summarise(sc_richness_group_by, richness = n())
##### combine richness into data fram with zeros
sc_richness = left_join(sc_richness_pre, sc_richness_sums)
head(sc_richness)
sc_richness$richness[is.na(sc_richness$richness)] = 0
head(sc_richness)
tail(sc_richness)
##### run the analysis
t.test(subset(sc_richness, location == 'under')$richness,
subset(sc_richness, location == 'away')$richness,
paired = T)
sc_live_group_by_plot = group_by(sc_live, date, plot, location)
sc_live_sums = summarise(sc_live_group_by_plot, cover_sum = sum(cover))
#### join cover sums to sc_live
sc_live_revised = left_join(sc_live, sc_live_sums)
#### get relative cover
sc_live_revised$cover_revised = sc_live_revised$cover / sc_live_revised$cover_sum
#### do diversity calcs
sc_live_revised$logcover = log(sc_live_revised$cover_revised) # percent cover squared
#### calculate diversity
sc_diversity_pre = data.frame(plot = rep(seq(1, 40), 2),
location = c(rep('under', 40), rep('away', 40)),
date = rep('2018-09-22', times = 80))
nrow(sc_diversity_pre)
#### get sum of cover2 by plot
sc_diversity_group_by = group_by(sc_live_revised, date, plot, location)
sc_diversity_sums = summarise(sc_diversity_group_by, logcover_sum = sum(logcover))
#### calculate diversity
sc_diversity_sums$H = -sc_diversity_sums$logcover_sum
##### combine diversity into data fram with zeros
sc_diversity = left_join(sc_diversity_pre, sc_diversity_sums)
head(sc_diversity)
sc_diversity$H[is.na(sc_diversity$H)] = 0
head(sc_diversity)
tail(sc_diversity)
diversity_boxplot = ggplot(data = sc_diversity, aes(x = location, y = H)) +
theme(legend.position="none",
axis.title.y=element_text(size=rel(4), colour = 'black'),
axis.title.x=element_text(size=rel(4), colour = 'black'),
axis.text.x=element_text(size=rel(4), colour = 'black'),
axis.text.y=element_text(size=rel(3), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
#axis.line = element_line(colour = 'black'),
strip.text = element_text(size=rel(1))) +
geom_boxplot(fill = c('yellow', 'grey'), lwd = 4) +
ylab('Shannon Diversity (H)') +
xlab('') +
scale_x_discrete(labels = c('away' = 'Outside', 'under' = 'Under'))
diversity_boxplot
